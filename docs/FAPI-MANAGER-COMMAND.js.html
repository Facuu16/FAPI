<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: FAPI-MANAGER-COMMAND.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: FAPI-MANAGER-COMMAND.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var PlayerCommandPreprocessEvent = Java.type("org.bukkit.event.player.PlayerCommandPreprocessEvent");

var commands;

var event = {
    player: null,
    message: null,
    command: null,
    arguments: null,
    permission: null,
    permission_message: null
};

function onInit() {
    API.setTempData("FAPI-MANAGER-COMMAND", getManager());
    commands = API.getTempData("FAPI-HANDLERS-COMMANDS") || [];

    API.registerListener(PlayerCommandPreprocessEvent.class, function(parent) {
        event.player = parent.getPlayer();
        event.message = parent.getMessage().split(" ");
        event.command = event.message[0].substring(1);
        event.arguments = event.message.slice(1);
    
        var FAPIEvent = {
            getPermission: function() {
                return event.permission;
            },
    
            getCommand: function() { 
                return event.command; 
            },
    
            getArguments: function() { 
                return event.arguments; 
            },
    
            getPlayer: function() { 
                return event.player; 
            },
    
            getHandlers: function () {
                return commands;
            }
        };
    
        for (var i = 0; i &lt; commands.length; i++) {
            var command = commands[i];
            
            if (event.command.toLowerCase() != command.name)
                continue;
            
            parent.setCancelled(true);
            event.permission = command.permission;
            event.permission_message = command.permission_message || "&amp;c¡No tienes los permisos necesarios!";

            if (event.permission != null) {
                if (!event.player.hasPermission(event.permission)) {
                    API.message(event.player, event.permission_message);
                    continue; 
                }
            }
    
            command.callback(FAPIEvent);
        }
    });
}

function getManager() {
    return {
        registerCommand: registerCommand,
    };
}

/**
 * @function
 * @description Registers a new command with the specified parameters. If a command with the same name already exists, it updates its permission and callback, otherwise, it adds a new command to the list.
 * 
 * @param {String} name - The name of the command to register.
 * @param {String} permission - The permission required to use the command.
 * @param {String} permission_message - The message displayed if the user does not have the required permission.
 * @param {Function} callback - The function to be executed when the command is used.
 * 
 * @returns {void}
 */
function registerCommand(name, permission, permission_message, callback) {
    var exists = false;

    commands.forEach(function(command) {
        if (command.name == name) {
            command.permission = permission;
            command.permission_message = permission_message;
            command.callback = callback;
            exists = true;
            return;
        }
    });

    if (!exists) {
        commands.push({
            name: name,
            permission: permission,
            permission_message: permission_message,
            callback: callback
        });
        API.setTempData("FAPI-HANDLERS-COMMANDS", commands);
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#contains">contains</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#hasArmor">hasArmor</a></li><li><a href="global.html#registerCommand">registerCommand</a></li><li><a href="global.html#remove">remove</a></li><li><a href="global.html#setColor">setColor</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Sun Feb 05 2023 10:33:30 GMT-0300 (hora estándar de Argentina)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
